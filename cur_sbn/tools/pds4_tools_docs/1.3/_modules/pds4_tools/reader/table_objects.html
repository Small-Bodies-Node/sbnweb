
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pds4_tools.reader.table_objects &#8212; PDS4 Python Tools 1.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinxdoc.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">PDS4 Python Tools 1.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pds4_tools.reader.table_objects</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pds4_tools.reader.table_objects</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">.general_objects</span> <span class="kn">import</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">Meta_Class</span><span class="p">,</span> <span class="n">Meta_Structure</span>
<span class="kn">from</span> <span class="nn">.label_objects</span> <span class="kn">import</span> <span class="n">Meta_SpectralCharacteristics</span>
<span class="kn">from</span> <span class="nn">.data_types</span> <span class="kn">import</span> <span class="n">pds_to_numpy_name</span><span class="p">,</span> <span class="n">PDSdtype</span>

<span class="kn">from</span> <span class="nn">..utils.compat</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">..utils.helpers</span> <span class="kn">import</span> <span class="n">is_array_like</span><span class="p">,</span> <span class="n">dict_extract</span>
<span class="kn">from</span> <span class="nn">..utils.exceptions</span> <span class="kn">import</span> <span class="n">PDS4StandardsException</span>
<span class="kn">from</span> <span class="nn">..utils.logging</span> <span class="kn">import</span> <span class="n">logger_init</span>

<span class="kn">from</span> <span class="nn">..extern</span> <span class="kn">import</span> <span class="n">six</span>
<span class="kn">from</span> <span class="nn">..extern.six.moves</span> <span class="kn">import</span> <span class="n">collections_abc</span>
<span class="kn">from</span> <span class="nn">..extern.cached_property</span> <span class="kn">import</span> <span class="n">threaded_cached_property</span>

<span class="c1"># Initialize the logger</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logger_init</span><span class="p">()</span>

<span class="c1">#################################</span>


<div class="viewcode-block" id="TableStructure"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableStructure">[docs]</a><span class="k">class</span> <span class="nc">TableStructure</span><span class="p">(</span><span class="n">Structure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Stores a single PDS4 table data structure.</span>

<span class="sd">    Contains the table&#39;s data, meta data and label portion. All forms of PDS4 tables</span>
<span class="sd">    (e.g. Table_Character, Table_Binary and Table_Delimited) are stored by this class.</span>

<span class="sd">    See `Structure`&#39;s and `pds4_read`&#39;s docstrings for attributes, properties and usage instructions</span>
<span class="sd">    of this object.</span>

<span class="sd">    Inherits all Attributes and Parameters from `Structure`. Overrides `info`, `data` and `from_file`</span>
<span class="sd">    methods to implement them.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TableStructure.from_file"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableStructure.from_file">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data_filename</span><span class="p">,</span> <span class="n">structure_label</span><span class="p">,</span> <span class="n">full_label</span><span class="p">,</span>
                  <span class="n">lazy_load</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">no_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">decode_strings</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a table structure from relevant labels and file for the data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data_filename : str or unicode</span>
<span class="sd">            Filename of the data file that contained the data for this table structure.</span>
<span class="sd">        structure_label : Label</span>
<span class="sd">            The segment of the label describing only this table structure.</span>
<span class="sd">        full_label : Label</span>
<span class="sd">            The entire label describing the PDS4 product this structure originated from.</span>
<span class="sd">        no_scale : bool, optional</span>
<span class="sd">            Read-in data will not be adjusted according to the offset and scaling factor. Defaults to False.</span>
<span class="sd">        decode_strings : bool, optional</span>
<span class="sd">            If True, strings data types contained in the returned data will be decoded to</span>
<span class="sd">            the ``unicode`` type in Python 2, and to the ``str`` type in Python 3. If</span>
<span class="sd">            false, leaves string types as byte strings. Defaults to False.</span>
<span class="sd">        lazy_load : bool, optional</span>
<span class="sd">            If True, does not read-in the data of this structure until the first attempt to access it.</span>
<span class="sd">            Defaults to False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TableStructure</span>
<span class="sd">            An object representing the PDS4 table structure; contains its label, data and meta data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Create the meta data structure for this table</span>
        <span class="n">meta_table_structure</span> <span class="o">=</span> <span class="n">Meta_TableStructure</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="n">structure_label</span><span class="p">,</span> <span class="n">full_label</span><span class="p">)</span>

        <span class="c1"># Create the data structure for this table</span>
        <span class="n">table_structure</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">structure_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">structure_meta_data</span><span class="o">=</span><span class="n">meta_table_structure</span><span class="p">,</span>
                              <span class="n">structure_label</span><span class="o">=</span><span class="n">structure_label</span><span class="p">,</span> <span class="n">full_label</span><span class="o">=</span><span class="n">full_label</span><span class="p">,</span>
                              <span class="n">parent_filename</span><span class="o">=</span><span class="n">data_filename</span><span class="p">)</span>
        <span class="n">table_structure</span><span class="o">.</span><span class="n">_no_scale</span> <span class="o">=</span> <span class="n">no_scale</span>
        <span class="n">table_structure</span><span class="o">.</span><span class="n">_decode_strings</span> <span class="o">=</span> <span class="n">decode_strings</span>

        <span class="c1"># Attempt to access the data property such that the data gets read-in (if not on lazy-load)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">lazy_load</span><span class="p">:</span>
            <span class="n">table_structure</span><span class="o">.</span><span class="n">data</span>

        <span class="k">return</span> <span class="n">table_structure</span></div>

<div class="viewcode-block" id="TableStructure.from_fields"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableStructure.from_fields">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">no_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">decode_strings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">structure_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a table structure from PDS-compliant data or meta data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fields : list[PDS_ndarray, PDS_marray or Meta_Field]</span>
<span class="sd">            A list of either fields with data, where each must contain a valid PDS4 meta_data attribute</span>
<span class="sd">            defining the field, or a list of valid Meta_Field&#39;s.</span>
<span class="sd">        no_scale : bool, optional</span>
<span class="sd">            If True, and input is a list of fields with data, then the data will scaled according to the</span>
<span class="sd">            scaling_factor and value_offset meta data. If the *fields* is meta data only, then the output</span>
<span class="sd">            data type will be large enough to store the scaled values. If False, no scaling or data type</span>
<span class="sd">            conversions will be done. Defaults to False.</span>
<span class="sd">        decode_strings : bool, optional</span>
<span class="sd">            If True, then fields containing character byte data will be converted to a dtype of unicode.</span>
<span class="sd">            If False, then for character data the obtained dtype will remain byte strings. Defaults to</span>
<span class="sd">            False.</span>
<span class="sd">        masked : bool or None, optional</span>
<span class="sd">            If True, and input is a list of fields with data, then the data will retain any masked values and</span>
<span class="sd">            in additional have numeric Special_Constants values masked. If False, any masked values in the</span>
<span class="sd">            input fields will be unmasked and data assignments will not preserve masked values. If None,</span>
<span class="sd">            masked values in the input will be retained only if any are present. Defaults to None.</span>
<span class="sd">        structure_kwargs : dict, optional</span>
<span class="sd">            Keywords that are passed directly to the `TableStructure` constructor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TableStructure</span>
<span class="sd">            An object representing the PDS4 table structure. The data will contain a structured array that</span>
<span class="sd">            can store values for *fields* (or does store it, if input is a list of fields with data). Other</span>
<span class="sd">            attributes may be specified via *structure_kwargs*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">.read_tables</span> <span class="kn">import</span> <span class="n">new_table</span>

        <span class="k">return</span> <span class="n">new_table</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">no_scale</span><span class="o">=</span><span class="n">no_scale</span><span class="p">,</span> <span class="n">decode_strings</span><span class="o">=</span><span class="n">decode_strings</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="n">masked</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">structure_kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="TableStructure.info"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableStructure.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abbreviated</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Prints a summary of this data structure.</span>

<span class="sd">        Contains the type, number of fields and number of records in the Table.</span>
<span class="sd">        If *abbreviated* is True then also outputs the name and number of elements</span>
<span class="sd">        for each field in the table.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        abbreviated : bool, optional</span>
<span class="sd">            If False, output additional detail. Defaults to False.</span>
<span class="sd">        output : file, bool or None, optional</span>
<span class="sd">            A file-like object to write the output to.  If set to False then instead of outputting</span>
<span class="sd">            to a file a list representing the summary parameters for the Structure is returned.</span>
<span class="sd">            Writes to ``sys.stdout`` by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None or list</span>
<span class="sd">            If output is False, then returns a list representing the summary parameters for the Structure.</span>
<span class="sd">            Otherwise returns None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Set default output to write to command line</span>
        <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

        <span class="c1"># Obtain abbreviated version of summary</span>
        <span class="n">dimensions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_data</span><span class="o">.</span><span class="n">dimensions</span><span class="p">()</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="s2">&quot;&#39;</span><span class="si">{0}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="n">field_info</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> fields x </span><span class="si">{1}</span><span class="s1"> records&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">summary_args</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">field_info</span><span class="p">]</span>
        <span class="n">abbreviated_info</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> </span><span class="si">{1}</span><span class="s2"> (</span><span class="si">{2}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">summary_args</span><span class="p">)</span>

        <span class="c1"># If output is false, return list representing the various parameters of the summary</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">summary_args</span>

        <span class="c1"># Otherwise write out summary to output</span>
        <span class="k">if</span> <span class="n">abbreviated</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">abbreviated_info</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Fields for </span><span class="si">{0}</span><span class="s1">: </span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">abbreviated_info</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>

                <span class="n">name</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="n">full_name</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">meta_data</span><span class="o">.</span><span class="n">full_name</span><span class="p">(</span><span class="n">separator</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>

                <span class="n">full_name_print</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="n">full_name</span><span class="p">:</span>
                    <span class="n">full_name_print</span> <span class="o">=</span> <span class="s1">&#39; (full name: </span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>

                <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="n">full_name_print</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">output</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div>

<div class="viewcode-block" id="TableStructure.__getitem__"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableStructure.__getitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get data for specific field in `TableStructure`.</span>

<span class="sd">        In the case of GROUP fields, the key can include the full location for disambiguation,</span>
<span class="sd">        (e.g. field_name = &#39;GROUP_1, GROUP_0, field_name&#39;). See `info` method for full locations of all</span>
<span class="sd">        fields.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str, unicode, int, slice or tuple</span>
<span class="sd">            Selection for desired field. May be a string containing the name of a field to search for,</span>
<span class="sd">            similar to ``dict`` indexing functionality. May be an integer or slice specifying which field(s)&#39;</span>
<span class="sd">            data to select,  similar to ``list`` or ``tuple`` indexing functionality. May be a two-valued</span>
<span class="sd">            tuple, with the first value providing the field name and the second value a zero-based repetition</span>
<span class="sd">            selector count if there are multiple fields with the same name.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PDS_ndarray, PDS_marray or None</span>
<span class="sd">            The data for the matched field, or None if no match found.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        IndexError</span>
<span class="sd">            Raised if *key* is a larger int than there are fields in the table.</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if *key* contains a name that does not match any field in the table.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; table_struct[&#39;First_Field_Name&#39;]</span>
<span class="sd">        &gt;&gt;&gt; table_struct.field(0)</span>

<span class="sd">        To access two fields at the same time by name,</span>

<span class="sd">        &gt;&gt;&gt; table_struct[[&#39;First_Field&#39;, &#39;Second_Field&#39;]]</span>

<span class="sd">        In-case of GROUP fields, we can use the full name (as given by the `info` method) for disambiguation,</span>

<span class="sd">        &gt;&gt;&gt; table_struct[&#39;GROUP_1, GROUP_0, field_name&#39;]</span>

<span class="sd">        If both of the first two data structures have the name &#39;Field_Name&#39;, then to select the second</span>
<span class="sd">        we can do,</span>

<span class="sd">        &gt;&gt;&gt; table_structure[&#39;Field_Name [1]&#39;]</span>
<span class="sd">        &gt;&gt;&gt; table_struct.field(&#39;Field_Name&#39;, 1)</span>

<span class="sd">        We can also record record-wise. To obtain all fields for the first five records,</span>

<span class="sd">        &gt;&gt;&gt; table_struct[0:5]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Search by full or partial field name for single-valued search</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="c1"># Search by full or partial field name for multi-valued search</span>
        <span class="k">elif</span> <span class="n">is_array_like</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">character</span><span class="p">):</span>

                <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">_key</span><span class="p">)</span> <span class="k">for</span> <span class="n">_key</span> <span class="ow">in</span> <span class="n">key</span><span class="p">]</span>
                <span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">pds_to_numpy_name</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">meta_data</span><span class="o">.</span><span class="n">full_name</span><span class="p">())</span>
                               <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">]</span>

                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_names</span><span class="p">]</span>

        <span class="c1"># Allow all other searches (slice, specific indexes, etc)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span></div>

<div class="viewcode-block" id="TableStructure.__len__"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableStructure.__len__">[docs]</a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Number of fields contained in the table.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_loaded</span><span class="p">:</span>
            <span class="n">num_fields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">dimensions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_data</span><span class="o">.</span><span class="n">dimensions</span><span class="p">()</span>
            <span class="n">num_fields</span> <span class="o">=</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">num_fields</span></div>

<div class="viewcode-block" id="TableStructure.field"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableStructure.field">[docs]</a>    <span class="k">def</span> <span class="nf">field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">repetition</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get data for specific field in table.</span>

<span class="sd">        In the case of GROUP fields, the key can include the full location for disambiguation,</span>
<span class="sd">        (e.g. *key* = &#39;GROUP_1, GROUP_0, field_name&#39;). See `info` method for full locations of all</span>
<span class="sd">        fields.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str, unicode, int or slice</span>
<span class="sd">            Selection for desired field. May be an integer or slice specifying which field(s)&#39; data</span>
<span class="sd">            to select,  similar to ``list`` or ``tuple`` indexing functionality. May be a string</span>
<span class="sd">            containing the name of a field to search for.</span>
<span class="sd">        repetition : int, optional</span>
<span class="sd">            If there are multiple fields with the same name, specifies a zero-based repetition count</span>
<span class="sd">            to return. Defaults to 0.</span>
<span class="sd">        all : bool, optional</span>
<span class="sd">            If there are multiple fields with the same name, setting to True indicates that</span>
<span class="sd">            all fields should be returned in a ``list``. If set, and no match is found</span>
<span class="sd">            then an empty list will be returned. Defaults to False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PDS_ndarray or PDS_marray</span>
<span class="sd">            The data for the field(s).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        IndexError</span>
<span class="sd">            Raised if *key* is a larger integer than there are fields in the table.</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if *key* is a name that does not match any field.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">            See :func:`TableStructure.__getitem__` method examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">return_fields</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Search by index or slice</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">integer_types</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="c1"># Search by name (full or partial)</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">meta_data</span><span class="o">.</span><span class="n">full_name</span><span class="p">()</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">return_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">return_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

        <span class="c1"># Return result</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">return_fields</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">repetition</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">return_fields</span><span class="p">[</span><span class="n">repetition</span><span class="p">]</span>

        <span class="k">elif</span> <span class="nb">all</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">return_fields</span>

        <span class="k">if</span> <span class="n">repetition</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Field &#39;</span><span class="si">{0}</span><span class="s2">&#39; (repetition </span><span class="si">{1}</span><span class="s2">) not found.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">repetition</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Field &#39;</span><span class="si">{0}</span><span class="s2">&#39; not found.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">))</span></div>

    <span class="nd">@threaded_cached_property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; All data in the PDS4 table data structure.</span>

<span class="sd">        This property is implemented as a thread-safe cacheable attribute. Once it is run</span>
<span class="sd">        for the first time, it replaces itself with an attribute having the exact</span>
<span class="sd">        data that was originally returned.</span>

<span class="sd">        Unlike normal properties, this property/attribute is settable without a __set__ method.</span>
<span class="sd">        To never run the read-in routine inside this property, you need to manually create the</span>
<span class="sd">        the ``.data`` attribute prior to ever invoking this method (or pass in the data to the</span>
<span class="sd">        constructor on object instantiation, which does this for you).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PDS_ndarray or PDS_marray</span>
<span class="sd">            A structured array (either effectively np.ndarray or np.ma.MaskedArray) representing all the</span>
<span class="sd">            fields in this table.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">TableStructure</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>

        <span class="kn">from</span> <span class="nn">.read_tables</span> <span class="kn">import</span> <span class="n">read_table_data</span>
        <span class="n">read_table_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">no_scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_no_scale</span><span class="p">,</span> <span class="n">decode_strings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_decode_strings</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_masked</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[PDS_ndarray or PDS_marray]</span>
<span class="sd">            All the fields in this table.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">]</span>

<div class="viewcode-block" id="TableStructure.set_field"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableStructure.set_field">[docs]</a>    <span class="k">def</span> <span class="nf">set_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">meta_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set a field in the table.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Prior to calling this method, ``self.data`` must be set to a structured ``ndarray`` that will be</span>
<span class="sd">        used to store each field. See `TableStructure.from_fields`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : array_like</span>
<span class="sd">            Data for the field to be added.</span>
<span class="sd">        meta_data : Meta_Field</span>
<span class="sd">            Meta data of the field to be added.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_loaded</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Unable to add field: backing data structure has not been initialized.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">set_field</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">meta_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="TableStructure.as_masked"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableStructure.as_masked">[docs]</a>    <span class="k">def</span> <span class="nf">as_masked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtain a new TableStructure, where numeric fields with Special_Constants are masked.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The returned Structure may not be easily converted back to unmasked. However, the original</span>
<span class="sd">        Structure can continue to be used to access the unmasked data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TableStructure</span>
<span class="sd">            A new structure, where numeric fields with Special_Constants are masked. The data, labels and</span>
<span class="sd">            meta data are all effectively views, no copies are made.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;structure_meta_data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_data</span><span class="p">,</span>
                  <span class="s1">&#39;structure_label&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="s1">&#39;full_label&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_label</span><span class="p">,</span>
                  <span class="s1">&#39;parent_filename&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_filename</span><span class="p">,</span> <span class="s1">&#39;structure_id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">}</span>

        <span class="c1"># If data is already loaded, create a view of the TableStructure where the data is masked</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_loaded</span><span class="p">:</span>

            <span class="n">table_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_fields</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">,</span> <span class="n">no_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">decode_strings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                               <span class="n">masked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">structure_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># If the data has not been loaded, create a view of TableStructure that indicates to mask data</span>
        <span class="c1"># when the attempt to access it is made later</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">table_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">table_structure</span><span class="o">.</span><span class="n">_no_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_scale</span>
            <span class="n">table_structure</span><span class="o">.</span><span class="n">_decode_strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode_strings</span>
            <span class="n">table_structure</span><span class="o">.</span><span class="n">_masked</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">table_structure</span></div></div>


<div class="viewcode-block" id="Meta_TableStructure"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_TableStructure">[docs]</a><span class="k">class</span> <span class="nc">Meta_TableStructure</span><span class="p">(</span><span class="n">Meta_Structure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Meta data about a PDS4 table data structure.</span>

<span class="sd">    Meta data stored in this class is accessed in ``dict``-like fashion.  Stores meta data about all forms</span>
<span class="sd">    of Table (e.g. Table_Character, Table_Binary, and Table_Delimited). Normally this meta data originates</span>
<span class="sd">    from the label (e.g., if this is an Table_Character then everything from the opening tag of</span>
<span class="sd">    Table_Character to its closing tag will be stored in this object), via the `from_label` method.</span>

<span class="sd">    Inherits all Attributes, Parameters and Properties from `Meta_Structure`.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    record : OrderedDict</span>
<span class="sd">        Convenience attribute for the Record_* portion of this table&#39;s meta data.</span>
<span class="sd">    type : str or unicode</span>
<span class="sd">        Type of table. One of &#39;Character&#39;, &#39;Binary&#39;, or &#39;Delimited&#39;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    Supposing the following Table definition from a label::</span>

<span class="sd">        &lt;Table_Binary&gt;</span>
<span class="sd">          &lt;local_identifier&gt;data_Integration&lt;/local_identifier&gt;</span>
<span class="sd">          ....</span>
<span class="sd">          &lt;Record_Binary&gt;</span>
<span class="sd">            &lt;fields&gt;9&lt;/fields&gt;</span>
<span class="sd">            &lt;groups&gt;0&lt;/groups&gt;</span>
<span class="sd">            &lt;record_length unit=&quot;byte&quot;&gt;65&lt;/record_length&gt;</span>
<span class="sd">            &lt;Field_Binary&gt;</span>
<span class="sd">              &lt;name&gt;TIMESTAMP&lt;/name&gt;</span>
<span class="sd">              ...</span>
<span class="sd">           ...</span>
<span class="sd">        ...</span>
<span class="sd">        &lt;/Table_Binary&gt;</span>

<span class="sd">    &gt;&gt;&gt; meta_table = Meta_TableStructure.from_label(structure_xml, full_label)</span>

<span class="sd">    &gt;&gt;&gt; print(meta_table[&#39;local_identifier&#39;])</span>
<span class="sd">    data_Integration</span>

<span class="sd">    &gt;&gt;&gt; print(meta_table[&#39;Record_Binary&#39;][&#39;record_length&#39;]</span>
<span class="sd">    65</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Meta_TableStructure</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="c1"># Type of table (Character, Binary, Delimited)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Record_* (Character, Binary, Delimited) of the table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">record</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Contains the Meta_SpectralCharacteristics for this Table structure, if it exists in the label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectral_characteristics</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="Meta_TableStructure.from_label"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_TableStructure.from_label">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_table</span><span class="p">,</span> <span class="n">full_label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a Meta_TableStructure from the XML portion describing the Table structure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xml_table : Label or ElementTree Element</span>
<span class="sd">            Portion of label that defines the Table data structure.</span>
<span class="sd">        full_label : Label or ElementTree Element, optional</span>
<span class="sd">            The entire label from which *xml_table* originated.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Meta_TableStructure</span>
<span class="sd">            Instance containing meta data about the table structure, as taken from the XML label.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        PDS4StandardsException</span>
<span class="sd">            Raised if required meta data is absent.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_load_keys_from_xml</span><span class="p">(</span><span class="n">xml_table</span><span class="p">)</span>

        <span class="c1"># Store record meta data with a variable name that is independent of the table-type</span>
        <span class="n">record_str</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">xml_table</span> <span class="k">if</span> <span class="s1">&#39;Record_&#39;</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">record_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">record</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="n">record_str</span><span class="p">]</span>

        <span class="c1"># Ensure required keys for delimited tables exist</span>
        <span class="k">if</span> <span class="s1">&#39;delimited&#39;</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>

            <span class="c1"># Ensure required keys for table exist</span>
            <span class="n">keys_must_exist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="s1">&#39;records&#39;</span><span class="p">,</span> <span class="s1">&#39;record_delimiter&#39;</span><span class="p">,</span> <span class="s1">&#39;field_delimiter&#39;</span><span class="p">,</span> <span class="n">record_str</span><span class="p">]</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_check_keys_exist</span><span class="p">(</span><span class="n">keys_must_exist</span><span class="p">)</span>

            <span class="c1"># Ensure required keys for table&#39;s record exist</span>
            <span class="n">keys_must_exist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span> <span class="s1">&#39;groups&#39;</span><span class="p">]</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_check_keys_exist</span><span class="p">(</span><span class="n">keys_must_exist</span><span class="p">,</span> <span class="n">sub_element</span><span class="o">=</span><span class="n">record_str</span><span class="p">)</span>

        <span class="c1"># Ensure required keys for fixed-width tables exist</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># Ensure required keys for table exist</span>
            <span class="n">keys_must_exist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="s1">&#39;records&#39;</span><span class="p">,</span> <span class="n">record_str</span><span class="p">]</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_check_keys_exist</span><span class="p">(</span><span class="n">keys_must_exist</span><span class="p">)</span>

            <span class="c1"># Ensure required keys for table&#39;s record exist</span>
            <span class="n">keys_must_exist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span> <span class="s1">&#39;groups&#39;</span><span class="p">,</span> <span class="s1">&#39;record_length&#39;</span><span class="p">]</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_check_keys_exist</span><span class="p">(</span><span class="n">keys_must_exist</span><span class="p">,</span> <span class="n">sub_element</span><span class="o">=</span><span class="n">record_str</span><span class="p">)</span>

        <span class="c1"># Add Meta_SpectralCharacteristics if they exist in the label</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;local_identifier&#39;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">full_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>

            <span class="n">local_identifier</span> <span class="o">=</span> <span class="n">six</span><span class="o">.</span><span class="n">text_type</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;local_identifier&#39;</span><span class="p">])</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">spectral_characteristics</span> <span class="o">=</span> <span class="n">Meta_SpectralCharacteristics</span><span class="o">.</span><span class="n">from_full_label</span><span class="p">(</span><span class="n">full_label</span><span class="p">,</span> <span class="n">local_identifier</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="n">PDS4StandardsException</span><span class="p">):</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="Meta_TableStructure.dimensions"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_TableStructure.dimensions">[docs]</a>    <span class="k">def</span> <span class="nf">dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtains the number of fields and records for the table.</span>

<span class="sd">        Count does not include Group_Fields, but includes any non-group fields with-in them.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            Dimensions of the table, i.e., the number of fields and records, respectively.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">normal_fields</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">dict_extract</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="p">,</span> <span class="s1">&#39;fields&#39;</span><span class="p">))</span>
        <span class="n">uni_sampled</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;Uniformly_Sampled&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="n">fields</span> <span class="o">=</span> <span class="n">normal_fields</span> <span class="o">+</span> <span class="n">uni_sampled</span>
        <span class="n">records</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;records&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">fields</span><span class="p">,</span> <span class="n">records</span><span class="p">]</span></div>

<div class="viewcode-block" id="Meta_TableStructure.is_fixed_width"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_TableStructure.is_fixed_width">[docs]</a>    <span class="k">def</span> <span class="nf">is_fixed_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the table is fixed-width (Table_Character and Table_Binary), false otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;character&#39;</span> <span class="ow">in</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;binary&#39;</span> <span class="ow">in</span> <span class="nb">type</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Meta_TableStructure.is_delimited"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_TableStructure.is_delimited">[docs]</a>    <span class="k">def</span> <span class="nf">is_delimited</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the table is delimited (Table_Delimited), false otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s1">&#39;delimited&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span></div></div>


<div class="viewcode-block" id="TableManifest"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest">[docs]</a><span class="k">class</span> <span class="nc">TableManifest</span><span class="p">(</span><span class="n">collections_abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Stores a single table&#39;s Meta_Fields and Meta_Groups</span>

<span class="sd">    The manifest is a representation the table, with fields and groups in the same order as they physically</span>
<span class="sd">    appear in the label, created by adding the appropriate Meta_Field and Meta_Group structures.</span>

<span class="sd">    The manifest is normally initialized from the label portion describing the Table, via `from_label`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    items : list[Meta_Field or Meta_Group], optional</span>
<span class="sd">        A list of Meta_Fields or Meta_Groups describing the Fields and Groups in this TableManifest.</span>
<span class="sd">    table_type : str or unicode, optional</span>
<span class="sd">        The type of table. One of</span>
<span class="sd">    table_label : Label or ElementTree Element, optional</span>
<span class="sd">        Portion of label that defines the PDS4 table data structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table_label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="p">(</span><span class="n">items</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">items</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span> <span class="o">=</span> <span class="n">table_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_table_label</span> <span class="o">=</span> <span class="n">table_label</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">TableManifest</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

<div class="viewcode-block" id="TableManifest.__getitem__"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest.__getitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : int or slice</span>
<span class="sd">            Index of requested field or group.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Meta_Field or Meta_Group</span>
<span class="sd">            Matched field or group meta data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">key</span><span class="p">]</span></div>

<div class="viewcode-block" id="TableManifest.__len__"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest.__len__">[docs]</a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Total number of fields and groups in the table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">)</span></div>

<div class="viewcode-block" id="TableManifest.from_label"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest.from_label">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">table_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a TableManifest from the XML portion describing the Table structure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table_label : Label or ElementTree Element</span>
<span class="sd">            Portion of label that defines the PDS4 table data structure.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TableManifest</span>
<span class="sd">            Instance containing all appropriate Meta_Field&#39;s and Meta_Group&#39;s.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Find the &lt;Record_*&gt; and set the table type (e.g. Character, Binary or Delimited)</span>
        <span class="n">record_str</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">table_label</span> <span class="k">if</span> <span class="s1">&#39;Record_&#39;</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">record_xml</span> <span class="o">=</span> <span class="n">table_label</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">record_str</span><span class="p">)</span>
        <span class="n">table_type</span> <span class="o">=</span> <span class="n">record_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">table_type</span><span class="o">=</span><span class="n">table_type</span><span class="p">,</span> <span class="n">table_label</span><span class="o">=</span><span class="n">table_label</span><span class="p">)</span>

        <span class="c1"># Add Uniformly_Sampled fields to the manifest</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_add_uniformly_sampled</span><span class="p">(</span><span class="n">table_label</span><span class="p">)</span>

        <span class="c1"># Add all fields and groups in &lt;Record_*&gt; to the manifest</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_add_fields_and_groups</span><span class="p">(</span><span class="n">record_xml</span><span class="p">)</span>

        <span class="c1"># Set group names for all groups</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_create_group_names</span><span class="p">()</span>

        <span class="c1"># Set location list for all fields and groups</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_create_full_locations</span><span class="p">()</span>

        <span class="c1"># Perform basic sanity and basic validation checking on the table</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_validate_table</span><span class="p">(</span><span class="n">record_xml</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">obj</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Total number of fields and groups in the table manifest.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_records</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_table_label</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">))</span>

        <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="TableManifest.fields"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest.fields">[docs]</a>    <span class="k">def</span> <span class="nf">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skip_uniformly_sampled</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtain all fields in the table manifest.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        skip_uniformly_sampled : bool, optional</span>
<span class="sd">            If True, uniformly sampled fields not added to the returned list. Defaults to False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[Meta_Field]</span>
<span class="sd">            All fields in the table manifest.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_field</span><span class="p">()</span> <span class="ow">and</span>
                <span class="p">(</span><span class="ow">not</span> <span class="n">skip_uniformly_sampled</span> <span class="ow">or</span> <span class="p">(</span><span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">uniformly_sampled_fields</span><span class="p">()))]</span></div>

<div class="viewcode-block" id="TableManifest.uniformly_sampled_fields"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest.uniformly_sampled_fields">[docs]</a>    <span class="k">def</span> <span class="nf">uniformly_sampled_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[Meta_FieldUniformlySampled]</span>
<span class="sd">            All Uniformly Sampled fields in the table manifest.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Meta_FieldUniformlySampled</span><span class="p">)]</span></div>

<div class="viewcode-block" id="TableManifest.groups"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest.groups">[docs]</a>    <span class="k">def</span> <span class="nf">groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[Meta_Group]</span>
<span class="sd">            All groups in the table manifest.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_group</span><span class="p">()]</span></div>

<div class="viewcode-block" id="TableManifest.get_field_by_full_name"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest.get_field_by_full_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_field_by_full_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_full_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns field(s) matched by full name.</span>

<span class="sd">        In the case of GROUP fields, the full name will include the full location for disambiguation,</span>
<span class="sd">        (e.g. field_full_name = &#39;GROUP_1, GROUP_0, field_name&#39;). The full location includes the names of</span>
<span class="sd">        the groups necessary to reach this field.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field_full_name : str or unicode</span>
<span class="sd">            The full name of the field(s) to search for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[Meta_Field]</span>
<span class="sd">            List of matched fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matching_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">full_name</span><span class="p">()</span> <span class="o">==</span> <span class="n">field_full_name</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">matching_fields</span></div>

<div class="viewcode-block" id="TableManifest.get_children_by_idx"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest.get_children_by_idx">[docs]</a>    <span class="k">def</span> <span class="nf">get_children_by_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_idx</span><span class="p">,</span> <span class="n">direct_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_idx</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtains the child items (Meta_Fields and Meta_Groups) of the *parent_idx* item.</span>

<span class="sd">        Child items of a Group field are other Fields and Groups inside said Group field,</span>
<span class="sd">        and the children of those groups, etc.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parent_idx : int</span>
<span class="sd">            The index (in this TableManifest) of the Meta_Group whose children to find.</span>
<span class="sd">            A value of -1 indicates to find all items in the entire manifest.</span>
<span class="sd">        direct_only : bool, optional</span>
<span class="sd">            If True, only the immediate children of the *parent_idx* element are returned. Defaults to False.</span>
<span class="sd">        return_idx : bool, optional</span>
<span class="sd">            If True, changes the return type to a ``list`` containing the indicies (in this TableManifest)</span>
<span class="sd">            of the matched children. Defaults to False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TableManifest</span>
<span class="sd">            A new table manifest containing only the matched children.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">return_idx</span><span class="p">:</span>
            <span class="n">children</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">children</span> <span class="o">=</span> <span class="n">TableManifest</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">parent_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">parent_item_group_lvl</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">parent_item_group_lvl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">parent_idx</span><span class="p">]</span><span class="o">.</span><span class="n">group_level</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">parent_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_items</span><span class="p">):</span>
            <span class="n">cur_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">cur_item</span><span class="o">.</span><span class="n">group_level</span> <span class="o">&gt;=</span> <span class="n">parent_item_group_lvl</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">cur_item</span><span class="o">.</span><span class="n">group_level</span> <span class="o">==</span> <span class="n">parent_item_group_lvl</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">direct_only</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">return_idx</span><span class="p">:</span>
                        <span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">children</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span><span class="n">cur_item</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">return</span> <span class="n">children</span></div>

<div class="viewcode-block" id="TableManifest.get_parent_by_idx"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest.get_parent_by_idx">[docs]</a>    <span class="k">def</span> <span class="nf">get_parent_by_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_idx</span><span class="p">,</span> <span class="n">return_idx</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtains the parent Meta_Group of the child item given by *child_idx*.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        child_idx : int</span>
<span class="sd">            The index (in this TableManifest) of the Meta_Field or Meta_Group whose parent to find.</span>
<span class="sd">        return_idx : bool, optional</span>
<span class="sd">            If True, changes the return type to an ``int``, which is the index (in this TableManifest) of the</span>
<span class="sd">            parent Meta_Group instead of the group itself. Returns -1 if a parent was not found. Defaults to</span>
<span class="sd">            False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Meta_Group or None</span>
<span class="sd">            The parent of the specified child, or None if a parent was not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">child_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">child_idx</span><span class="p">]</span>
        <span class="n">child_group_level</span> <span class="o">=</span> <span class="n">child_item</span><span class="o">.</span><span class="n">group_level</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">child_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">cur_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">cur_item</span><span class="o">.</span><span class="n">group_level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">child_group_level</span> <span class="ow">and</span> <span class="n">cur_item</span><span class="o">.</span><span class="n">is_group</span><span class="p">():</span>

                <span class="k">if</span> <span class="n">return_idx</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">i</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">cur_item</span>

        <span class="k">if</span> <span class="n">return_idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="TableManifest.get_parents_by_idx"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest.get_parents_by_idx">[docs]</a>    <span class="k">def</span> <span class="nf">get_parents_by_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_idx</span><span class="p">,</span> <span class="n">return_idx</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtains all Meta_Group parents of the child item given by *child_idx*.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        child_idx : int</span>
<span class="sd">            The index (in this TableManifest) of the Meta_Field or Meta_Group whose parent to find.</span>
<span class="sd">        return_idx : bool, optional</span>
<span class="sd">            If True, changes the return type to a list of ``int``&#39;s, each of which is an index (in this</span>
<span class="sd">            TableManifest) of the parent Meta_Group instead of the group itself. A value of -1 will be present</span>
<span class="sd">            in the list if no parent is found. Defaults to False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[Meta_Group]</span>
<span class="sd">            The parents of the specified child, or empty list if no parents were not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">child_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">child_idx</span><span class="p">]</span>
        <span class="n">parent_idx</span> <span class="o">=</span> <span class="n">child_idx</span>

        <span class="n">parent_groups</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Obtain values for all parents of child</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">child_item</span><span class="o">.</span><span class="n">group_level</span><span class="p">):</span>

            <span class="n">parent_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parent_by_idx</span><span class="p">(</span><span class="n">parent_idx</span><span class="p">,</span> <span class="n">return_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">parent_or_idx</span> <span class="o">=</span> <span class="n">parent_idx</span> <span class="k">if</span> <span class="n">return_idx</span> <span class="k">else</span> <span class="bp">self</span><span class="p">[</span><span class="n">parent_idx</span><span class="p">]</span>
            <span class="n">parent_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent_or_idx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">parent_groups</span></div>

<div class="viewcode-block" id="TableManifest.get_field_offset"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest.get_field_offset">[docs]</a>    <span class="k">def</span> <span class="nf">get_field_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_idx</span><span class="p">,</span> <span class="n">parent_idx</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtains the number of data values between *parent_idx* and *field_idx* in a single record.</span>

<span class="sd">        Each value in a record is a single field value, or a single repetition of a field value. If all</span>
<span class="sd">        the data values for all fields in a single record were combined into an array, then data_array[offset]</span>
<span class="sd">        (with the default *parent_idx*) would select that field&#39;s value (or the value of its first</span>
<span class="sd">        repetition, for fields inside groups).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field_idx : int</span>
<span class="sd">            The index (in this TableManifest) of the Meta_Field whose offset to find.</span>
<span class="sd">        parent_idx : int, optional</span>
<span class="sd">            The parent index (index of one of the group fields that *field_idx* is inside of), from which</span>
<span class="sd">            to calculate the offset to *field_idx*. If None, calculates the offset from the beginning of the</span>
<span class="sd">            record. Defaults to None.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of values, where each repetition of any field also counts as a separate value, that</span>
<span class="sd">            are between *parent_idx* and *field_idx* (inclusive).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">offset_num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">field_idx</span><span class="p">]</span>

        <span class="c1"># Calculate the offset from beginning of record unless otherwise requested</span>
        <span class="k">if</span> <span class="n">parent_idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parent_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># Iterate over every child of `parent_idx` until we reach the `field`</span>
        <span class="k">for</span> <span class="n">child_item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_children_by_idx</span><span class="p">(</span><span class="n">parent_idx</span><span class="p">,</span> <span class="n">direct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">child_item</span> <span class="ow">is</span> <span class="n">field</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="k">elif</span> <span class="n">child_item</span><span class="o">.</span><span class="n">is_field</span><span class="p">():</span>
                <span class="n">offset_num</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">elif</span> <span class="n">child_item</span><span class="o">.</span><span class="n">is_group</span><span class="p">():</span>

                <span class="n">full_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">child_item</span><span class="p">)</span>
                <span class="n">offset_add</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_field_offset</span><span class="p">(</span><span class="n">field_idx</span><span class="p">,</span> <span class="n">parent_idx</span><span class="o">=</span><span class="n">full_index</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_children_by_idx</span><span class="p">(</span><span class="n">full_index</span><span class="p">):</span>
                    <span class="n">offset_num</span> <span class="o">+=</span> <span class="n">offset_add</span>
                    <span class="k">break</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">offset_num</span> <span class="o">+=</span> <span class="n">offset_add</span> <span class="o">*</span> <span class="n">child_item</span><span class="p">[</span><span class="s1">&#39;repetitions&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">offset_num</span></div>

<div class="viewcode-block" id="TableManifest.get_field_skip_factors"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.TableManifest.get_field_skip_factors">[docs]</a>    <span class="k">def</span> <span class="nf">get_field_skip_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_idx</span><span class="p">,</span> <span class="n">parent_idxs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtains the number of data values between each repetition of *field_idx* for every parent group.</span>

<span class="sd">        Each value in a record is a single field value, or a single repetition of a field value. If each</span>
<span class="sd">        skip factor were multiplied by the max number of repetitions for that group, and the results were</span>
<span class="sd">        added together then that skip value would represent the number of data values between the first</span>
<span class="sd">        value in the field and the last value in the field.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field_idx : int</span>
<span class="sd">            The index (in this TableManifest) of the Meta_Field whose offset to find.</span>
<span class="sd">        parent_idxs : list[int], optional</span>
<span class="sd">            The parent indexes (indexes of group fields that *field_idx* is inside of) for which to</span>
<span class="sd">            calculate the skip factors. If None, selects the parent indexes for all groups that *field_idx*</span>
<span class="sd">            is inside of. Defaults to None.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[int]</span>
<span class="sd">            Each item in the list is the number of values, where each repetition of any field also counts</span>
<span class="sd">            as a separate value, between each repetition of the field for that group. The values are</span>
<span class="sd">            in reverse order from *parent_idxs*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">skip_factors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">field_idx</span><span class="p">]</span>

        <span class="c1"># Calculate skip factors for all groups that `field` is unless requested otherwise</span>
        <span class="k">if</span> <span class="n">parent_idxs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">item_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
            <span class="n">parent_idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parents_by_idx</span><span class="p">(</span><span class="n">item_idx</span><span class="p">,</span> <span class="n">return_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Iterate over every group</span>
        <span class="k">for</span> <span class="n">parent_idx</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">parent_idxs</span><span class="p">):</span>

            <span class="n">skip_factor</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># For each group that `field` is inside of, find the amount of other fields and groups; this</span>
            <span class="c1"># is how many other values will need to be skipped until we reach `field` on the next repetition.</span>
            <span class="k">for</span> <span class="n">child_item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_children_by_idx</span><span class="p">(</span><span class="n">parent_idx</span><span class="p">,</span> <span class="n">direct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">child_item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">field</span><span class="p">)</span> <span class="ow">and</span> <span class="n">child_item</span><span class="o">.</span><span class="n">is_field</span><span class="p">():</span>
                    <span class="n">skip_factor</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">elif</span> <span class="n">child_item</span><span class="o">.</span><span class="n">is_group</span><span class="p">():</span>

                    <span class="n">child_idx</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">child_item</span><span class="p">)]</span>
                    <span class="n">skip_factor</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_field_skip_factors</span><span class="p">(</span><span class="n">field_idx</span><span class="p">,</span> <span class="n">parent_idxs</span><span class="o">=</span><span class="n">child_idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> \
                                   <span class="o">*</span> <span class="n">child_item</span><span class="p">[</span><span class="s1">&#39;repetitions&#39;</span><span class="p">]</span>

            <span class="n">skip_factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skip_factor</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">skip_factors</span></div>

    <span class="k">def</span> <span class="nf">_insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">field_or_group</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Inserts an item (Meta_Field or Meta_Group) into the manifest.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : int</span>
<span class="sd">            The key (index) the item will have in this TableManifest.</span>
<span class="sd">        field_or_group : Meta_Field or Meta_Group</span>
<span class="sd">            The field or group to insert.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">field_or_group</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_or_group</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Appends an item (Meta_Field or Meta_Group) at the end of the manifest.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field_or_group : Meta_Field or Meta_Group</span>
<span class="sd">            The field or group to append.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field_or_group</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_fields_and_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xml_parent</span><span class="p">,</span> <span class="n">group_level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds all &lt;Field_*&gt;s and &lt;Group_Field_*&gt;s which are direct children of xml_parent to the</span>
<span class="sd">        TableManifest, and then recursively all children of the &lt;Group_Field_*&gt;s.</span>

<span class="sd">        The end result, when this is called on the &lt;Record_*&gt; of a table, is to add all Fields</span>
<span class="sd">        and all Groups defined inside &lt;Record_*&gt; into the manifest.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xml_parent : Label or ElementTree Element</span>
<span class="sd">            An XML element containing &lt;Field_*&gt; or &lt;Group_Field_*&gt; tags as children.</span>
<span class="sd">        group_level : int, optional</span>
<span class="sd">            The depth the current elements being added are nested from the &lt;Record_*&gt;. Defaults to 0,</span>
<span class="sd">            which means direct children. (Only non-zero for children of Group fields.)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">field_tag</span> <span class="o">=</span> <span class="s1">&#39;Field_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span>
        <span class="n">group_tag</span> <span class="o">=</span> <span class="s1">&#39;Group_Field_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span>

        <span class="c1"># Work around ElementTree not having ability to findall based on multiple conditions</span>
        <span class="c1"># while preserving order</span>
        <span class="n">elements_xml</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">xml_parent</span>
                        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="n">field_tag</span> <span class="ow">or</span>
                        <span class="n">element</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="n">group_tag</span><span class="p">]</span>

        <span class="c1"># Iterate over all fields and groups</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements_xml</span><span class="p">:</span>

            <span class="c1"># Append Fields to Data</span>
            <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="n">field_tag</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span> <span class="o">==</span> <span class="s1">&#39;Character&#39;</span><span class="p">:</span>
                    <span class="n">field_type</span> <span class="o">=</span> <span class="n">Meta_FieldCharacter</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span> <span class="o">==</span> <span class="s1">&#39;Binary&#39;</span><span class="p">:</span>
                    <span class="n">field_type</span> <span class="o">=</span> <span class="n">Meta_FieldBinary</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span> <span class="o">==</span> <span class="s1">&#39;Delimited&#39;</span><span class="p">:</span>
                    <span class="n">field_type</span> <span class="o">=</span> <span class="n">Meta_FieldDelimited</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown table type: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span><span class="p">)</span>

                <span class="n">field</span> <span class="o">=</span> <span class="n">field_type</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
                <span class="n">field_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

                <span class="n">field</span><span class="o">.</span><span class="n">group_level</span> <span class="o">=</span> <span class="n">group_level</span>
                <span class="n">field</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_item_shape</span><span class="p">(</span><span class="n">field_idx</span><span class="p">))</span>

            <span class="c1"># Append Groups (and recursively sub-Fields and sub-Groups) to Data</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="n">group</span> <span class="o">=</span> <span class="n">Meta_Group</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

                <span class="n">group</span><span class="o">.</span><span class="n">group_level</span> <span class="o">=</span> <span class="n">group_level</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_fields_and_groups</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">group_level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_uniformly_sampled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_xml</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Add &lt;Uniformly_Sampled&gt; fields into the manifest.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table_xml : Label or ElementTree Element</span>
<span class="sd">            Portion of label that defines the PDS4 table data structure.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">table_xml</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Uniformly_Sampled&#39;</span><span class="p">):</span>

            <span class="n">field</span> <span class="o">=</span> <span class="n">Meta_FieldUniformlySampled</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
            <span class="n">field_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

            <span class="n">field</span><span class="o">.</span><span class="n">group_level</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">field</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_item_shape</span><span class="p">(</span><span class="n">field_idx</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_create_group_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a name for each Meta_Group in the manifest that was not given one in the label.</span>

<span class="sd">        PDS4 Standards make group field names optional. This method creates names where necessary, with the</span>
<span class="sd">        format &#39;GROUP_n&#39;, where n is an integer from 0 to infinity (depending on the number of groups).</span>
<span class="sd">        In groups that are nested inside other groups, n will start from 0 regardless of the name of the</span>
<span class="sd">        parent group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        group_level : int, optional</span>
<span class="sd">            The depth the current group being named is nested from the &lt;Record_*&gt;. Defaults to 0,</span>
<span class="sd">            which means direct child.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_indicies</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">)</span>
                          <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_group</span><span class="p">()</span>
                          <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">group_level</span> <span class="o">==</span> <span class="n">group_level</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_indicies</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">prev_parent</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">group_idx</span> <span class="ow">in</span> <span class="n">group_indicies</span><span class="p">:</span>

            <span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">group_idx</span><span class="p">]</span>
            <span class="n">parent_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parent_by_idx</span><span class="p">(</span><span class="n">group_idx</span><span class="p">,</span> <span class="n">return_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">parent_idx</span> <span class="o">==</span> <span class="n">prev_parent</span><span class="p">:</span>
                <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="s1">&#39;name&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
                <span class="n">group</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;GROUP_&#39;</span> <span class="o">+</span> <span class="n">six</span><span class="o">.</span><span class="n">text_type</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>

            <span class="n">prev_parent</span> <span class="o">=</span> <span class="n">parent_idx</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_create_group_names</span><span class="p">(</span><span class="n">group_level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_full_locations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sets the correct full locations for all Meta_Fields and Meta_Groups in the manifest.</span>

<span class="sd">        A full location is a ``list`` of ``dict``s, where each ``dict`` has a single key and a single</span>
<span class="sd">        value. All together these keys and values indicate the full path to the table element from the</span>
<span class="sd">        beginning of the &lt;Record_*&gt;. Available keys are: &#39;field&#39;, &#39;group&#39;, and &#39;overlap&#39;. A field key</span>
<span class="sd">        has a value corresponding to the name of a (non-group) field. A group key has a value corresponding</span>
<span class="sd">        to the name of a group field. An overlap has a value corresponding to the overlap number of the</span>
<span class="sd">        preceding field or group (zero-based index).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        Suppose the following Example Label Outline::</span>

<span class="sd">            Table_Binary: Observations</span>
<span class="sd">                Field: order</span>
<span class="sd">                Field: wavelength           (1)</span>
<span class="sd">                Group: unnamed</span>
<span class="sd">                        Field: pos_vector   (2)</span>
<span class="sd">                Group: unnamed</span>
<span class="sd">                    Group: unnamed</span>
<span class="sd">                        Field: pos_vector</span>
<span class="sd">                        Field: pos_vector   (3)</span>

<span class="sd">        The full locations of the fields labeled above in parenthesis are as follows:</span>

<span class="sd">        (1) [{&#39;field&#39;: &#39;wavelength&#39;}]</span>

<span class="sd">        (2) [{&#39;group&#39;: &#39;GROUP_0&#39;},</span>
<span class="sd">             {&#39;field&#39;: &#39;pos_vector&#39;}]</span>

<span class="sd">        (3) [{&#39;group&#39;: &#39;GROUP_1&#39;},</span>
<span class="sd">             {&#39;group&#39;: &#39;GROUP_0&#39;},</span>
<span class="sd">             {&#39;field&#39;: &#39;pos_vector&#39;},</span>
<span class="sd">             {&#39;overlap&#39;: &#39;1&#39;}]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">):</span>

            <span class="n">full_location</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="c1"># Begin by adding item name to full location</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">i</span>

            <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;group&#39;</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_group</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;field&#39;</span>
            <span class="n">full_location</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">{</span><span class="nb">type</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]})</span>

            <span class="c1"># Find _struct indicies of items having the same name and group location as current item</span>
            <span class="n">identical_idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_overlapping_item_idxs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

            <span class="c1"># Add overlap count for groups and fields that have the same name and same group location</span>
            <span class="c1"># (otherwise these groups and fields would have exactly the same full name)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">identical_idxs</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">full_location</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;overlap&#39;</span><span class="p">:</span> <span class="n">identical_idxs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)})</span>

            <span class="n">parent_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parent_by_idx</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">return_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Add field parent group&#39;s full location</span>
            <span class="c1"># (this should already contain locations of all prior groups)</span>
            <span class="k">if</span> <span class="n">parent_idx</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">parent_idx</span><span class="p">]</span>

                <span class="c1"># Add parent group&#39;s location</span>
                <span class="n">group_full_location</span> <span class="o">=</span> <span class="p">[</span><span class="n">location</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">full_location</span><span class="p">]</span>
                <span class="n">group_full_location</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">full_location</span><span class="p">)</span>
                <span class="n">full_location</span> <span class="o">=</span> <span class="n">group_full_location</span>

            <span class="n">item</span><span class="o">.</span><span class="n">full_location</span> <span class="o">=</span> <span class="n">full_location</span>

    <span class="k">def</span> <span class="nf">_get_overlapping_item_idxs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overlapping items are those Meta_Field&#39;s and Meta_Group&#39;s that have the same type (i.e., either</span>
<span class="sd">        field or group), name, and group location as `table_manifest[item_idx]`. The simplest case is two</span>
<span class="sd">        fields with the same name in a table without groups. To disambiguate these fields there is special</span>
<span class="sd">        handling, but first we need to find them, which is the purpose of this method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item_idx : int</span>
<span class="sd">            The index (in this TableManifest) of the Meta_Field or Meta_Group whose overlapping items</span>
<span class="sd">            to find.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[int]</span>
<span class="sd">            Indexes (in this TableManifest) of the Meta_Field&#39;s or Meta_Group&#39;s that overlap with `item_idx`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">item_idx</span><span class="p">]</span>
        <span class="n">item_parent_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parent_by_idx</span><span class="p">(</span><span class="n">item_idx</span><span class="p">,</span> <span class="n">return_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">overlapping_item_idxs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Determine if we&#39;re looking for overlapping fields or overlapping groups</span>
        <span class="n">find_fields</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_group</span><span class="p">():</span>
            <span class="n">find_fields</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">child_idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_children_by_idx</span><span class="p">(</span><span class="n">item_parent_idx</span><span class="p">,</span> <span class="n">direct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">child_idxs</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">find_fields</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">is_group</span><span class="p">())</span> <span class="ow">or</span> <span class="p">(</span>
                   <span class="ow">not</span> <span class="n">find_fields</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">is_group</span><span class="p">()):</span>

                    <span class="n">overlapping_item_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">overlapping_item_idxs</span>

    <span class="k">def</span> <span class="nf">_get_item_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtain dimensions of item given by *item_idx*.</span>

<span class="sd">        Normally this would be used only on Meta_Field items, to obtain the dimensions of the array needed</span>
<span class="sd">        for that field&#39;s data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item_idx : int</span>
<span class="sd">            The index (in this TableManifest) of the Meta_Field or Meta_Group whose shape to obtain.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[int]</span>
<span class="sd">            Dimensions of the item. For fields not inside groups, this will be equivalent to the number of</span>
<span class="sd">            records.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">item_shape</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">num_records</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">parent_group</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parents_by_idx</span><span class="p">(</span><span class="n">item_idx</span><span class="p">):</span>
            <span class="n">item_shape</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">parent_group</span><span class="p">[</span><span class="s1">&#39;repetitions&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">item_shape</span>

    <span class="k">def</span> <span class="nf">_validate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_xml</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs basic sanity checks on the table and basic verification of some PDS4 standards</span>
<span class="sd">        not currently tested by the schema and schematron.</span>

<span class="sd">        Checks performed:</span>
<span class="sd">            1) Ensure &lt;fields&gt; matches number of Field_* (including for nested fields)</span>
<span class="sd">            2) Ensure &lt;groups&gt; matches number of Group_Field_* (including for nested groups)</span>
<span class="sd">            3) Ensure the &lt;format&gt; of each field, if given, is valid according to the PDS4 standards</span>
<span class="sd">            4) Ensure that &lt;group_repetitions&gt; mod &lt;group_length&gt; equals zero for all group fields</span>

<span class="sd">        If any of the optional checks (1-3) fail, a warning is output. It is normally safe to continue.</span>
<span class="sd">        If an unsafe check fails, an exception is raised.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        record_xml : Label or ElementTree Element</span>
<span class="sd">            The Record_* portion of the label for this table.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        PDS4StandardsException</span>
<span class="sd">           Raised if group_repetitions do not evenly divide into group_length for all group fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check that number of fields and groups claimed matches number of &lt;Field_*&gt; and &lt;Group_Field_*&gt;</span>
        <span class="n">num_rec_fields</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">record_xml</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">))</span>
        <span class="n">num_rec_groups</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">record_xml</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s1">&#39;groups&#39;</span><span class="p">))</span>

        <span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">group_level</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="n">skip_uniformly_sampled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">group_level</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

        <span class="n">fields_mismatch_warn</span> <span class="o">=</span> <span class="s1">&#39;&lt;fields&gt; value does not match number of &lt;Field_</span><span class="si">{0}</span><span class="s1">&gt; in&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span><span class="p">)</span>
        <span class="n">groups_mismatch_warn</span> <span class="o">=</span> <span class="s1">&#39;&lt;groups&gt; value does not match number of &lt;Group_Field_</span><span class="si">{0}</span><span class="s1">&gt; in&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">!=</span> <span class="n">num_rec_fields</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> Record_</span><span class="si">{1}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fields_mismatch_warn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">!=</span> <span class="n">num_rec_groups</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> Record_</span><span class="si">{1}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">groups_mismatch_warn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_struct</span><span class="p">):</span>

            <span class="n">full_location_warn</span> <span class="o">=</span> <span class="s2">&quot;&#39;</span><span class="si">{0}</span><span class="s2">&#39; (full location: &#39;</span><span class="si">{1}</span><span class="s2">&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">item</span><span class="o">.</span><span class="n">full_name</span><span class="p">(</span><span class="s1">&#39; -&gt; &#39;</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_group</span><span class="p">():</span>

                <span class="c1"># Check number of fields and groups matching in nested groups</span>
                <span class="n">children</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_children_by_idx</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">direct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">child</span> <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span> <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">is_group</span><span class="p">()]</span>
                <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">child</span> <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">child</span><span class="o">.</span><span class="n">is_group</span><span class="p">()]</span>

                <span class="c1"># For fixed-width tables, check that group_length is evenly divisible by group_repetitions</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span> <span class="o">!=</span> <span class="s1">&#39;Delimited&#39;</span><span class="p">:</span>

                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">!=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">]:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">fields_mismatch_warn</span> <span class="o">+</span> <span class="s1">&#39; group &#39;</span> <span class="o">+</span> <span class="n">full_location_warn</span><span class="p">)</span>

                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">!=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;groups&#39;</span><span class="p">]:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">groups_mismatch_warn</span> <span class="o">+</span> <span class="s1">&#39; group &#39;</span> <span class="o">+</span> <span class="n">full_location_warn</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">%</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;repetitions&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">PDS4StandardsException</span><span class="p">(</span><span class="s2">&quot;Group length &#39;</span><span class="si">{0}</span><span class="s2">&#39; must be evenly divisible by the &quot;</span>
                                                     <span class="s2">&quot;number of repetitions &#39;</span><span class="si">{1}</span><span class="s2">&#39; for group </span><span class="si">{2}</span><span class="s2">&quot;</span>
                                                     <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;repetitions&#39;</span><span class="p">],</span>
                                                             <span class="n">full_location_warn</span><span class="p">))</span>

            <span class="k">elif</span> <span class="s1">&#39;format&#39;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>

                <span class="c1"># Ensure field_format requirements</span>
                <span class="n">valid_field_format</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^%([\+,-])?([0-9]+)(\.([0-9]+))?([doxfeEs])$&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_field_format</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">]):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;field_format &#39;</span><span class="si">{0}</span><span class="s2">&#39; does not conform to PDS4 standards for field </span><span class="si">{1}</span><span class="s2"> &quot;</span>
                                   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">],</span> <span class="n">full_location_warn</span><span class="p">))</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="n">is_numeric</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ASCII_Real&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                  <span class="s1">&#39;ASCII_Integer&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                  <span class="s1">&#39;ASCII_NonNegative_Integer&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                  <span class="s1">&#39;ASCII_Numeric_Base2&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                  <span class="s1">&#39;ASCII_Numeric_Base8&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                  <span class="s1">&#39;ASCII_Numeric_Base16&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">],</span> <span class="kc">False</span><span class="p">)</span>

                    <span class="n">sub_exp</span> <span class="o">=</span> <span class="n">valid_field_format</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>

                    <span class="n">plus_minus</span> <span class="o">=</span> <span class="n">sub_exp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="n">sub_exp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">precision</span> <span class="o">=</span> <span class="n">sub_exp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">specifier</span> <span class="o">=</span> <span class="n">sub_exp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">plus_minus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                        <span class="k">if</span> <span class="n">plus_minus</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_numeric</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;field_format &#39;</span><span class="si">{0}</span><span class="s2">&#39; may not have &#39;+&#39; for a numeric data_type &#39;</span><span class="si">{1}</span><span class="s2">&#39; for &quot;</span>
                                           <span class="s2">&quot;field </span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">],</span> <span class="n">full_location_warn</span><span class="p">))</span>

                        <span class="k">elif</span> <span class="n">plus_minus</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">is_numeric</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;field_format &#39;</span><span class="si">{0}</span><span class="s2">&#39; may not have &#39;-&#39; for a non-numeric data_type &#39;</span><span class="si">{1}</span><span class="s2">&#39; for &quot;</span>
                                           <span class="s2">&quot;field </span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">],</span> <span class="n">full_location_warn</span><span class="p">))</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_type</span> <span class="o">==</span> <span class="s1">&#39;Character&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">!=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;in Table_Character field_format &#39;</span><span class="si">{0}</span><span class="s2">&#39; width must be equal to field_length &quot;</span>
                                       <span class="s2">&quot;&#39;</span><span class="si">{1}</span><span class="s2">&#39; for field </span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">],</span> <span class="n">full_location_warn</span><span class="p">))</span>

                    <span class="k">if</span> <span class="n">precision</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">specifier</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="n">precision</span><span class="p">):</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;field_format &#39;</span><span class="si">{0}</span><span class="s2">&#39; precision must be equal to width &#39;</span><span class="si">{1}</span><span class="s2">&#39; for a string format &quot;</span>
                                       <span class="s2">&quot;for field </span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">],</span> <span class="n">width</span><span class="p">,</span> <span class="n">full_location_warn</span><span class="p">))</span></div>


<div class="viewcode-block" id="Meta_TableElement"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_TableElement">[docs]</a><span class="nd">@six</span><span class="o">.</span><span class="n">add_metaclass</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Meta_TableElement</span><span class="p">(</span><span class="n">Meta_Class</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Stores meta data about any table element.</span>

<span class="sd">    Table elements are Fields and Group fields. Subclassed by Meta_Field, Meta_Group and their derivatives.</span>

<span class="sd">    Meta data stored in this class is accessed in ``dict``-like fashion.  See docstring for `Meta_Class`</span>
<span class="sd">    for additional documentation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    (same as for `Meta_Class` and ``OrderedDict``)</span>

<span class="sd">    *args</span>
<span class="sd">        Variable length argument list.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        Arbitrary keyword arguments.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    full_location : list[dict]</span>
<span class="sd">        See docstring for ``TableManifest._create_full_locations``.</span>
<span class="sd">    group_level : int</span>
<span class="sd">        The depth the element is nested from the &lt;Record_*&gt;. 0 means direct child.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Meta_TableElement</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">full_location</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_level</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="Meta_TableElement.from_label"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_TableElement.from_label">[docs]</a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">element_xml</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializes the meta data from an XML description of the element.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        element_xml : Label or ElementTree Element</span>
<span class="sd">            Portion of the label describing this element.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Meta_TableElement</span>
<span class="sd">            Instance containing meta data from *element_xml*.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="Meta_TableElement.full_name"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_TableElement.full_name">[docs]</a>    <span class="k">def</span> <span class="nf">full_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="n">skip_parents</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The full name of the element.</span>

<span class="sd">        The full name always includes an overlap disambiguator, to resolve two elements in the same</span>
<span class="sd">        location with the same name. Normally it also includes the name of any parent groups necessary</span>
<span class="sd">        to reach this element from the beginning of the record description.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        separator : str or unicode, optional</span>
<span class="sd">            Used as the string separating each parent group and the name of the element. Defaults to &#39;, &#39;.</span>
<span class="sd">        skip_parents : bool, optional</span>
<span class="sd">            If True, parent groups of the element are excluded from the full name. Defaults to False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str or unicode</span>
<span class="sd">            The name, including overlap disambiguator and parent groups if enabled, of the element.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        Suppose the following Example Label Outline::</span>

<span class="sd">            Table_Binary: Observations</span>
<span class="sd">                Field: order</span>
<span class="sd">                Field: wavelength           (1)</span>
<span class="sd">                Group: unnamed</span>
<span class="sd">                        Field: pos_vector   (2)</span>
<span class="sd">                Group: unnamed</span>
<span class="sd">                    Group: example_group</span>
<span class="sd">                        Field: pos_vector</span>
<span class="sd">                        Field: pos_vector   (3)</span>

<span class="sd">        The full name of each element, with the default separator, is:</span>

<span class="sd">        (1) wavelength</span>
<span class="sd">        (2) GROUP_0, pos_vector</span>
<span class="sd">        (3) GROUP_1, example_group, pos_vector [1]</span>

<span class="sd">        Enabling skip_parents for element (3) would result in &#39;pos_vector [1]&#39;, which includes the</span>
<span class="sd">        overlap disambiguator, but excludes all parent groups.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Attempt to begin extraction of name from full location</span>
        <span class="n">full_name</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_location</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># If full location is not set (should only be the case if this a fake field, for all fields</span>
        <span class="c1"># read from a real table full location should always be set), try to extract a name from</span>
        <span class="c1"># the name attribute</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">full_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">):</span>
            <span class="n">full_name</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="c1"># Build name by looping over the full location</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># If we are skipping outputting parent groups and fields, then find</span>
            <span class="c1"># the last index of a field or group in `self.full_location`</span>
            <span class="k">if</span> <span class="n">skip_parents</span><span class="p">:</span>

                <span class="n">start_idx</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_location</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>

                    <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_location</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="s1">&#39;field&#39;</span><span class="p">]:</span>
                        <span class="n">start_idx</span> <span class="o">=</span> <span class="n">i</span>
                        <span class="k">break</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">start_idx</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># Location from which to start building the full name</span>
            <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_location</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:]</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">location</span><span class="p">)):</span>

                <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">six</span><span class="o">.</span><span class="n">text_type</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>

                <span class="c1"># Add key/value to name</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;overlap&#39;</span><span class="p">:</span>
                    <span class="n">full_name</span> <span class="o">+=</span> <span class="s1">&#39; [</span><span class="si">{0}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">full_name</span> <span class="o">+=</span> <span class="n">value</span>

                <span class="c1"># Insert the separator where necessary (following group and field)</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>

                    <span class="n">next_key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">next_key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="s1">&#39;field&#39;</span><span class="p">]:</span>
                        <span class="n">full_name</span> <span class="o">+=</span> <span class="n">separator</span>

        <span class="k">return</span> <span class="n">full_name</span></div>

<div class="viewcode-block" id="Meta_TableElement.is_field"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_TableElement.is_field">[docs]</a>    <span class="k">def</span> <span class="nf">is_field</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if this element is a Field (i.e. Field_*), false otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Meta_Field</span><span class="p">)</span></div>

<div class="viewcode-block" id="Meta_TableElement.is_group"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_TableElement.is_group">[docs]</a>    <span class="k">def</span> <span class="nf">is_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if this element is a Group field (i.e. Group_Field_*), false otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Meta_Group</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Meta_Field"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_Field">[docs]</a><span class="k">class</span> <span class="nc">Meta_Field</span><span class="p">(</span><span class="n">Meta_TableElement</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot; Stores meta data about a single &lt;Field_*&gt;.</span>

<span class="sd">    Subclassed by `Meta_FieldCharacter`, `Meta_FieldBinary`, `Meta_FieldDelimited` and</span>
<span class="sd">    `Meta_FieldUniformlySampled`.</span>

<span class="sd">    Inherits ``full_location`` and ``group_level`` attributes from `Meta_TableElement`.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    shape : tuple[int]</span>
<span class="sd">        The dimensions of the field&#39;s data. For fields not inside groups, this will be equivalent to</span>
<span class="sd">        the number of records.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Keys starting with the &#39;field\_&#39; prefix have this prefix removed.</span>
<span class="sd">    All other keys preserve their XML names.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    Supposing the following Field definition from a label::</span>

<span class="sd">        &lt;Field_Binary&gt;</span>
<span class="sd">          &lt;name&gt;UTC&lt;/name&gt;</span>
<span class="sd">          &lt;field_location unit=&quot;byte&quot;&gt;17&lt;/field_location&gt;</span>
<span class="sd">          &lt;data_type&gt;ASCII_String&lt;/data_type&gt;</span>
<span class="sd">          &lt;field_length unit=&quot;byte&quot;&gt;33&lt;/field_length&gt;</span>
<span class="sd">          &lt;unit&gt;UTC date string&lt;/unit&gt;</span>
<span class="sd">          &lt;description&gt;Time that the integration began&lt;/description&gt;</span>
<span class="sd">        &lt;/Field_Binary&gt;</span>

<span class="sd">    &gt;&gt;&gt; field = Meta_Field.from_label(field_xml)</span>

<span class="sd">    &gt;&gt;&gt; print(field[&#39;name&#39;])</span>
<span class="sd">    UTC</span>

<span class="sd">    &gt;&gt;&gt; print(field[&#39;length&#39;])</span>
<span class="sd">    33</span>

<span class="sd">    &gt;&gt;&gt; print(field.keys())</span>
<span class="sd">    [&#39;name&#39;, &#39;location&#39;, &#39;data_type&#39;, &#39;length&#39;, &#39;unit&#39;, &#39;description&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Meta_Field</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="Meta_Field.from_label"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_Field.from_label">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field_xml</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializes the meta data from an XML description of the Field.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field_xml : Label or ElementTree Element</span>
<span class="sd">            Portion of the label describing this Field.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Meta_Field</span>
<span class="sd">            Contains meta data for the field.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">_load_keys_from_xml</span><span class="p">(</span><span class="n">field_xml</span><span class="p">,</span> <span class="n">tag_modify</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;field_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_check_keys_exist</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="Meta_Field.data_type"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_Field.data_type">[docs]</a>    <span class="k">def</span> <span class="nf">data_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Data type of the field.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        All fields, except Uniformly Sampled fields, must specify the data type. Uniformly Sampled fields</span>
<span class="sd">        default to ASCII_Real with-in this code.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PDSdtype</span>
<span class="sd">            A PDS4 data type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data_type&#39;</span><span class="p">,</span> <span class="s1">&#39;ASCII_Real&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">PDSdtype</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Meta_FieldCharacter"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_FieldCharacter">[docs]</a><span class="k">class</span> <span class="nc">Meta_FieldCharacter</span><span class="p">(</span><span class="n">Meta_Field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Stores meta data about a single &lt;Field_Character&gt;.</span>

<span class="sd">    Inherits ``shape`` attribute from `Meta_Field`. Inherits ``full_location`` and ``group_level``</span>
<span class="sd">    attributes from `Meta_TableElement`.</span>

<span class="sd">    See docstring of `Meta_Field` for usage information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Meta_FieldCharacter.from_label"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_FieldCharacter.from_label">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field_xml</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializes the meta data from an XML description of the element.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field_xml : Label or ElementTree Element</span>
<span class="sd">            Portion of the label describing this Field.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Meta_FieldCharacter</span>
<span class="sd">            Contains meta data for a Field_Character.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Meta_FieldCharacter</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="n">field_xml</span><span class="p">)</span>

        <span class="n">keys_must_exist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="s1">&#39;data_type&#39;</span><span class="p">]</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_check_keys_exist</span><span class="p">(</span><span class="n">keys_must_exist</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">obj</span></div></div>


<div class="viewcode-block" id="Meta_FieldBinary"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_FieldBinary">[docs]</a><span class="k">class</span> <span class="nc">Meta_FieldBinary</span><span class="p">(</span><span class="n">Meta_Field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Stores meta data about a single &lt;Field_Binary&gt;.</span>

<span class="sd">    Inherits ``shape`` attribute from `Meta_Field`. Inherits ``full_location`` and ``group_level``</span>
<span class="sd">    attributes from `Meta_TableElement`.</span>

<span class="sd">    See docstring of `Meta_Field` for usage information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Meta_FieldBinary.from_label"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_FieldBinary.from_label">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field_xml</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializes the meta data from an XML description of the Field.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field_xml : Label or ElementTree Element</span>
<span class="sd">            Portion of the label describing this Field.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Meta_FieldBinary</span>
<span class="sd">            Contains meta data for a Field_Binary.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Meta_FieldBinary</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="n">field_xml</span><span class="p">)</span>

        <span class="n">keys_must_exist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="s1">&#39;data_type&#39;</span><span class="p">]</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_check_keys_exist</span><span class="p">(</span><span class="n">keys_must_exist</span><span class="p">)</span>

        <span class="c1"># Add the bit fields</span>
        <span class="c1"># Note: bit fields not currently supported</span>
        <span class="c1"># packed_data = field_xml.find(&#39;Packed_Data_Fields&#39;)</span>
        <span class="c1"># if packed_data is not None:</span>
        <span class="c1">#</span>
        <span class="c1">#     bit_fields = packed_data.findall(&#39;Field_Bit&#39;)</span>
        <span class="c1">#</span>
        <span class="c1">#     for bit_field in bit_fields:</span>
        <span class="c1">#</span>
        <span class="c1">#         bit_field = Meta_FieldBit.from_label(bit_field)</span>
        <span class="c1">#         obj.bit_fields.append(bit_field)</span>

        <span class="k">return</span> <span class="n">obj</span></div></div>


<div class="viewcode-block" id="Meta_FieldDelimited"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_FieldDelimited">[docs]</a><span class="k">class</span> <span class="nc">Meta_FieldDelimited</span><span class="p">(</span><span class="n">Meta_Field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Stores meta data about a single &lt;Field_Delimited&gt;.</span>

<span class="sd">    Inherits ``shape`` attribute from `Meta_Field`. Inherits ``full_location`` and ``group_level``</span>
<span class="sd">    attributes from `Meta_TableElement`.</span>

<span class="sd">    See docstring of `Meta_Field` for usage information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Meta_FieldDelimited.from_label"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_FieldDelimited.from_label">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field_xml</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializes the meta data from an XML description of the Field.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field_xml : Label or ElementTree Element</span>
<span class="sd">            Portion of the label describing this Field.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Meta_FieldDelimited</span>
<span class="sd">            Contains meta data for a Field_Delimited.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Meta_FieldDelimited</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="n">field_xml</span><span class="p">)</span>

        <span class="n">keys_must_exist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">]</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_check_keys_exist</span><span class="p">(</span><span class="n">keys_must_exist</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">obj</span></div></div>


<div class="viewcode-block" id="Meta_FieldUniformlySampled"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_FieldUniformlySampled">[docs]</a><span class="k">class</span> <span class="nc">Meta_FieldUniformlySampled</span><span class="p">(</span><span class="n">Meta_Field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Stores meta data about a single &lt;Uniformly_Sampled&gt;.</span>

<span class="sd">    See docstring of `Meta_Field` for usage information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Meta_FieldUniformlySampled.from_label"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_FieldUniformlySampled.from_label">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">uniformly_sampled_xml</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializes the meta data from an XML description of the Uniformly_Sampled.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        uniformly_sampled_xml : Label or ElementTree Element</span>
<span class="sd">            Portion of the label describing this Uniformly Sampled field.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Meta_FieldUniformlySampled</span>
<span class="sd">            Contains meta data for a Uniformly_Sampled field.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">_load_keys_from_xml</span><span class="p">(</span><span class="n">uniformly_sampled_xml</span><span class="p">,</span> <span class="n">tag_modify</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;sampling_parameter_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">full_location</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]}]</span>

        <span class="n">keys_must_exist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;interval&#39;</span><span class="p">,</span> <span class="s1">&#39;first_value&#39;</span><span class="p">,</span> <span class="s1">&#39;last_value&#39;</span><span class="p">]</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_check_keys_exist</span><span class="p">(</span><span class="n">keys_must_exist</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">obj</span></div></div>


<span class="k">class</span> <span class="nc">Meta_FieldBit</span><span class="p">(</span><span class="n">Meta_Field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Stores meta data about a single &lt;Field_Bit&gt;. &quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field_bit_xml</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<div class="viewcode-block" id="Meta_Group"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_Group">[docs]</a><span class="k">class</span> <span class="nc">Meta_Group</span><span class="p">(</span><span class="n">Meta_TableElement</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot; Stores meta data about a single &lt;Group_Field_*&gt;.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Keys starting with the &#39;group\_&#39; prefix have this prefix removed.</span>
<span class="sd">    All other keys preserve their XML names.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    Supposing the following Group field definition from a label::</span>

<span class="sd">        &lt;Group_Field_Binary&gt;</span>
<span class="sd">          &lt;repetitions&gt;12&lt;/repetitions&gt;</span>
<span class="sd">          &lt;fields&gt;1&lt;/fields&gt;</span>
<span class="sd">          &lt;groups&gt;0&lt;/groups&gt;</span>
<span class="sd">          &lt;group_location unit=&quot;byte&quot;&gt;1&lt;/group_location&gt;</span>
<span class="sd">          &lt;group_length unit=&quot;byte&quot;&gt;24&lt;/group_length&gt;</span>
<span class="sd">          &lt;Field_Binary&gt;</span>
<span class="sd">            ...</span>
<span class="sd">          &lt;/Field_Binary&gt;</span>
<span class="sd">        &lt;/Group_Field_Binary&gt;</span>

<span class="sd">    &gt;&gt;&gt; group = Meta_Group.from_label(group_field_xml)</span>

<span class="sd">    &gt;&gt;&gt; print(group[&#39;repetitions&#39;])</span>
<span class="sd">    12</span>

<span class="sd">    &gt;&gt;&gt; print(group[&#39;location&#39;])</span>
<span class="sd">    1</span>

<span class="sd">    &gt;&gt;&gt; print(group.keys())</span>
<span class="sd">    [&#39;repetitions&#39;, &#39;fields&#39;, &#39;groups&#39;, &#39;location&#39;, &#39;length&#39;, &#39;Field_Binary&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Meta_Group.from_label"><a class="viewcode-back" href="../../../pds4_tools.reader.table_objects.html#pds4_tools.reader.table_objects.Meta_Group.from_label">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">group_field_xml</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializes the meta data from an XML description of the Group_Field.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        group_field_xml : Label or ElementTree Element</span>
<span class="sd">            Portion of the label describing this group field.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Meta_Group</span>
<span class="sd">            Contains meta data for Group_Field_* fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">_load_keys_from_xml</span><span class="p">(</span><span class="n">group_field_xml</span><span class="p">,</span> <span class="n">tag_modify</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;group_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>

        <span class="n">keys_must_exist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;repetitions&#39;</span><span class="p">,</span> <span class="s1">&#39;fields&#39;</span><span class="p">,</span> <span class="s1">&#39;groups&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;Delimited&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">group_field_xml</span><span class="o">.</span><span class="n">tag</span><span class="p">:</span>
            <span class="n">keys_must_exist</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">])</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">_check_keys_exist</span><span class="p">(</span><span class="n">keys_must_exist</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">obj</span></div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">PDS4 Python Tools 1.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pds4_tools.reader.table_objects</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015 - 2021, University of Maryland.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
  </body>
</html>